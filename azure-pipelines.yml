trigger:
- master
- develop

variables:
  packageBasename: 'descript-gstreamer'
  packageId: '$(Build.BuildNumber)'
  hostCores: 2

jobs:

- job: MacOS

  pool:
    vmImage: 'macOS-10.13'

  variables:
    packageName: '$(packageBaseName)-mac-$(packageId)'

  steps:

  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.x'
      addToPath: true

  - script: ./cerbero-uninstalled bootstrap -y
    displayName: Boostrapping cerbero

  - script: ./cerbero-uninstalled package gstreamer-1.0
    displayName: Building package gstreamer-1.0

  - script: mkdir $(packageName)
    displayName: Creating package $(packageName)

- job: Windows

  pool:
    vmImage: 'VS2017-Win2016'

  variables:
    packageName: '$(packageBaseName)-win-$(packageId)'

  steps:
  - script: mkdir $(packageName)
    displayName: Creating package $(packageName)

- job: Linux

  pool:
    vmImage: 'ubuntu-16.04'

  variables:
    packageName: '$(packageBaseName)-linux-$(packageId)'

  steps:
  - script: mkdir $(packageName)
    displayName: Creating package $(packageName)

  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.x'
      addToPath: true

